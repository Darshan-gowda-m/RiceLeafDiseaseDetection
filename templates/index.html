<!DOCTYPE html>
<html lang="en">

<head>
    <title>Rice Leaf Disease Prediction System</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css"
        crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        crossorigin="anonymous" />
    <style>
        :root {
            --primary-color: #4caf50;
            --secondary-color: #2e7d32;
            --accent-color: #ff9800;
            --light-bg: #eaffeb;
            --dark-text: #1b3b1b;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, var(--light-bg), #dbd4b5);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            color: var(--dark-text);
            position: relative;
            overflow-x: hidden;
        }



        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #e0f7fa, #ffffff);
            background-repeat: repeat;
            background-size: 150px;
            opacity: 0.05;
            z-index: 0;
            pointer-events: none;
        }

        header,
        main,
        footer {
            position: relative;
            z-index: 1;
        }

        header {
            padding: 20px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-bottom-left-radius: 25px;
            border-bottom-right-radius: 25px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        header h1 {
            margin: 0;
            font-size: 2rem;
            font-weight: 700;
            letter-spacing: 1px;
        }

        .nav-tabs .nav-link {
            color: var(--dark-text);
            font-weight: 500;
        }

        .nav-tabs .nav-link.active {
            color: var(--primary-color);
            font-weight: 700;
            border-bottom: 3px solid var(--primary-color);
        }

        main {
            flex: 1;
            padding: 40px 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 40px;
        }

        .section-container {
            background: #ffffffee;
            border-radius: 15px;
            padding: 30px;
            width: 100%;
            max-width: 1000px;
            box-shadow: 0px 10px 25px rgba(0, 0, 0, 0.15);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .section-container:hover {
            transform: translateY(-5px);
            box-shadow: 0px 15px 35px rgba(0, 0, 0, 0.2);
        }

        form {
            background: #ffffffee;
            border-radius: 15px;
            padding: 30px 25px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0px 10px 25px rgba(0, 0, 0, 0.15);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        form:hover {
            transform: translateY(-5px);
            box-shadow: 0px 15px 35px rgba(0, 0, 0, 0.2);
        }

        input[type="file"] {
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #ccc;
            width: 100%;
            margin-bottom: 20px;
            transition: border 0.3s ease;
        }

        input[type="file"]:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }

        .btn-primary:hover {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
        }

        .btn-outline-primary {
            color: var(--primary-color);
            border-color: var(--primary-color);
        }

        .btn-outline-primary:hover {
            background-color: var(--primary-color);
            color: white;
        }

        .dashboard {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 30px;
            width: 100%;
        }

        .image-container {
            flex: 1 1 300px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .image-container img {
            max-width: 100%;
            max-height: 300px;
            border-radius: 15px;
            box-shadow: 0px 10px 25px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease;
        }

        .image-container img:hover {
            transform: scale(1.03);
        }

        .predictions-container {
            flex: 1 1 350px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .prediction-card {
            background-color: #ffffffee;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0px 8px 20px rgba(0, 0, 0, 0.15);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .prediction-card:hover {
            transform: translateY(-5px);
            box-shadow: 0px 12px 30px rgba(0, 0, 0, 0.2);
        }

        .prediction-card h4 {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .confidence-bar {
            height: 10px;
            border-radius: 10px;
            background-color: #e0e0e0;
            margin-top: 8px;
            overflow: hidden;
        }

        .confidence-fill {
            height: 100%;
            border-radius: 10px;
            background: linear-gradient(90deg, var(--primary-color), #81c784);
            width: 0;
            animation: fillBar 1.5s forwards;
        }

        @keyframes fillBar {
            0% {
                width: 0%;
            }
        }

        footer {
            padding: 15px 20px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            color: white;
            text-align: center;
            border-top-left-radius: 25px;
            border-top-right-radius: 25px;
            box-shadow: 0 -6px 15px rgba(0, 0, 0, 0.15);
        }

        .loading-container {
            display: none;
            justify-content: center;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .loading-spinner {
            border: 6px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 6px solid var(--primary-color);
            width: 60px;
            height: 60px;
            animation: spin 1.5s linear infinite;
        }

        .center-container {
            display: flex;
            justify-content: center;
            /* horizontal centering */
            align-items: center;
            /* vertical centering */
            height: 100vh;
            /* full viewport height */
        }

        .disease-info {
            max-width: 900px;
            width: 90%;
            background-color: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .stats-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            width: 100%;
        }

        .stat-widget {
            background: #ffffffee;
            border-radius: 15px;
            padding: 20px;
            width: 200px;
            text-align: center;
            box-shadow: 0px 8px 20px rgba(0, 0, 0, 0.15);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .stat-widget:hover {
            transform: translateY(-5px);
            box-shadow: 0px 12px 30px rgba(0, 0, 0, 0.2);
        }

        .stat-widget h3 {
            margin: 10px 0;
            font-size: 1.8rem;
            color: var(--primary-color);
        }

        .stat-widget p {
            margin: 0;
            font-weight: 500;
        }

        .comparison-table {
            background: #ffffffee;
            border-radius: 15px;
            padding: 20px;
            width: 100%;
            max-width: 900px;
            box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.15);
            overflow-x: auto;
        }

        /* Center the whole comparison section */
        .comparison-table {
            display: flex;
            flex-direction: column;
            /* stack heading + table/chart vertically */
            align-items: center;
            /* horizontal center */
            margin: 40px auto;
            /* vertical spacing + auto horizontal */
            text-align: center;
            /* center text inside headings */
        }

        /* Style the table to have a max width */
        .comparison-table table {
            width: 80%;
            /* adjust as needed */
            max-width: 900px;
            margin: 0 auto;
            /* center table */
        }

        /* Optional: style canvas/chart */
        .comparison-table canvas {
            max-width: 80%;
            /* responsive width */
            margin-top: 20px;
        }


        .comparison-table table {
            width: 100%;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 12px 15px;
            text-align: center;
        }

        .comparison-table th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
        }

        .comparison-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .alert-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1050;
            min-width: 300px;
        }

        .alert {
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .alert-error {
            background-color: #ffebee;
            color: #c62828;
            border-left: 4px solid #c62828;
        }

        .alert-success {
            background-color: #e8f5e9;
            color: var(--secondary-color);
            border-left: 4px solid var(--secondary-color);
        }

        .disease-info {
            background: #ffffffee;
            border-radius: 15px;
            padding: 20px;
            width: 100%;
            max-width: 900px;
            box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.15);
        }

        .disease-info h4 {
            color: var(--secondary-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .info-card {
            background: #f1f8e9;
            border-radius: 10px;
            padding: 15px;
        }

        .upload-instructions {
            background: #e8f5e9;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
        }

        .prevention-tips {
            background: #e3f2fd;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
        }

        .prevention-tips ul {
            padding-left: 20px;
        }

        .resource-card {
            background: #f1f8e9;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .symptom-checker {
            background: #fff3e0;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .feature-card {
            transition: transform 0.3s ease;
            height: 100%;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .region-selector {
            background: #e3f2fd;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .weather-widget {
            background: #bbdefb;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .crop-calendar {
            background: #c8e6c9;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .scheme-card {
            transition: transform 0.3s ease;
            margin-bottom: 15px;
        }

        .scheme-card:hover {
            transform: translateY(-3px);
        }

        .query-form {
            background: #f3e5f5;
            border-radius: 10px;
            padding: 20px;
        }

        .market-price-widget {
            background: #ffecb3;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .fertilizer-calculator {
            background: #d7ccc8;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .scroll-target {
            scroll-margin-top: 100px;
        }

        .region-selector-top {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 10;
        }

        .upload-center {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 30px 0;
        }
    </style>
</head>

<body>
    <!-- Alert container for flash messages -->
    <div class="alert-container">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        {% for category, message in messages %}
        <div class="alert alert-{{ 'error' if category == 'error' else 'success' }}">
            <i class="fas fa-{{ 'exclamation-triangle' if category == 'error' else 'check-circle' }}"></i>
            {{ message }}
        </div>
        {% endfor %}
        {% endif %}
        {% endwith %}
    </div>

    <header>
        <div class="container">
            <div class="header-top">
                <h1><i class="fas fa-leaf"></i> Krishi Raksha - Rice Leaf Disease Prediction</h1>
                <div class="region-selector-top">
                    <form method="POST" action="/set_region" class="d-flex align-items-center">
                        <select class="form-select me-2" id="regionSelect" name="region" style="width: 150px;">
                            <option value="North India" {% if user_region=='North India' %}selected{% endif %}>North
                                India</option>
                            <option value="South India" {% if user_region=='South India' %}selected{% endif %}>South
                                India</option>
                            <option value="East India" {% if user_region=='East India' %}selected{% endif %}>East India
                            </option>
                            <option value="West India" {% if user_region=='West India' %}selected{% endif %}>West India
                            </option>
                            <option value="Central India" {% if user_region=='Central India' %}selected{% endif %}>
                                Central India</option>
                            <option value="North East India" {% if user_region=='North East India' %}selected{% endif
                                %}>North East India</option>
                        </select>
                        <button type="submit" class="btn btn-sm btn-primary">Set Region</button>
                    </form>
                </div>
            </div>
            <p class="mt-2">A comprehensive tool for Indian farmers to detect rice diseases and access prevention
                resources</p>
        </div>
    </header>

    <main class="container">
        <!-- Weather Widget -->
        {% if weather_data %}
        <div class="weather-widget">
            <h4><i class="fas fa-cloud-sun"></i> Weather in {{ user_region }}</h4>
            <div class="row">
                <div class="col-md-3">
                    <p><i class="fas fa-temperature-high"></i> Temperature: {{ weather_data.temperature }}°C</p>
                </div>
                <div class="col-md-3">
                    <p><i class="fas fa-tint"></i> Humidity: {{ weather_data.humidity }}%</p>
                </div>
                <div class="col-md-3">
                    <p><i class="fas fa-cloud"></i> Conditions: {{ weather_data.description }}</p>
                </div>
                <div class="col-md-3">
                    <p><i class="fas fa-cloud-rain"></i> Rain: {{ weather_data.rainfall }}</p>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Market Price Widget -->
        <div class="market-price-widget">
            <h4><i class="fas fa-rupee-sign"></i> Today's Rice Market Prices (per quintal)</h4>
            <div class="row">
                <div class="col-md-3">
                    <p><strong>Basmati:</strong> ₹4,500 - ₹5,200</p>
                </div>
                <div class="col-md-3">
                    <p><strong>Non-Basmati:</strong> ₹2,200 - ₹2,800</p>
                </div>
                <div class="col-md-3">
                    <p><strong>Paddy:</strong> ₹1,800 - ₹2,200</p>
                </div>
                <div class="col-md-3">
                    <p><strong>Source:</strong> <a href="https://agmarknet.gov.in/" target="_blank">Agmarknet</a></p>
                </div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <ul class="nav nav-tabs mb-4" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button"
                    role="tab" aria-controls="home" aria-selected="true">
                    <i class="fas fa-home"></i> Home
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="prevention-tab" data-bs-toggle="tab" data-bs-target="#prevention"
                    type="button" role="tab" aria-controls="prevention" aria-selected="false">
                    <i class="fas fa-shield-alt"></i> Prevention
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="resources-tab" data-bs-toggle="tab" data-bs-target="#resources"
                    type="button" role="tab" aria-controls="resources" aria-selected="false">
                    <i class="fas fa-hands-helping"></i> Government Schemes
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="symptoms-tab" data-bs-toggle="tab" data-bs-target="#symptoms" type="button"
                    role="tab" aria-controls="symptoms" aria-selected="false">
                    <i class="fas fa-stethoscope"></i> Symptom Checker
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="calendar-tab" data-bs-toggle="tab" data-bs-target="#calendar" type="button"
                    role="tab" aria-controls="calendar" aria-selected="false">
                    <i class="fas fa-calendar-alt"></i> Crop Calendar
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="expert-tab" data-bs-toggle="tab" data-bs-target="#expert" type="button"
                    role="tab" aria-controls="expert" aria-selected="false">
                    <i class="fas fa-user-md"></i> Expert Help
                </button>
            </li>
        </ul>

        <div class="tab-content" id="myTabContent">
            <!-- Home Tab -->
            <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                <div class="row mb-4">
                    <div class="col-md-4 mb-3">
                        <div class="card feature-card h-100">
                            <div class="card-body text-center">
                                <div class="feature-icon">
                                    <i class="fas fa-camera"></i>
                                </div>
                                <h5 class="card-title">Image Analysis</h5>
                                <p class="card-text">Upload an image of your rice leaf for instant disease detection
                                    using AI technology.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="card feature-card h-100">
                            <div class="card-body text-center">
                                <div class="feature-icon">
                                    <i class="fas fa-prescription-bottle"></i>
                                </div>
                                <h5 class="card-title">Treatment Guidance</h5>
                                <p class="card-text">Get specific treatment recommendations for identified diseases with
                                    Indian product names.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="card feature-card h-100">
                            <div class="card-body text-center">
                                <div class="feature-icon">
                                    <i class="fas fa-seedling"></i>
                                </div>
                                <h5 class="card-title">Prevention Tips</h5>
                                <p class="card-text">Learn how to prevent diseases before they affect your crops with
                                    region-specific advice.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="upload-center">
                    <form method="POST" enctype="multipart/form-data" id="uploadForm">
                        <div class="mb-3">
                            <label for="fileInput" class="form-label">Select rice leaf image:</label>
                            <input type="file" class="form-control" id="fileInput" name="file" required
                                accept="image/*">
                            <div class="form-text">Supported formats: JPG, PNG, GIF, BMP</div>
                        </div>
                        <button type="submit" class="btn btn-primary btn-lg w-100">
                            <i class="fas fa-search"></i> Analyze Image
                        </button>
                    </form>

                    <div class="upload-instructions">
                        <h5><i class="fas fa-info-circle"></i> Upload Guidelines</h5>
                        <ul class="mb-0">
                            <li>Ensure the image is clear and well-lit</li>
                            <li>Focus on the leaf area, minimizing background</li>
                            <li>For best results, use images of individual leaves</li>
                            <li>Avoid blurred or rotated images</li>
                        </ul>
                    </div>
                </div>

                {% if image_path %}
                <div class="dashboard mt-4 scroll-target" id="results-section">
                    <div class="image-container">
                        <h4>Uploaded Image</h4>
                        <img src="{{ image_path }}" alt="Uploaded Image">
                    </div>

                    <div class="predictions-container">
                        {% if predictions %}
                        <h3>Analysis Results</h3>

                        {% for model_name, prediction in predictions.items() %}
                        <div class="prediction-card">
                            <h4><i class="fas fa-robot"></i> {{ model_name }}</h4>
                            <p><strong>Prediction:</strong> {{ prediction.class }}</p>
                            <p><strong>Confidence:</strong> {{ (prediction.confidence * 100) | round(2) }}%</p>
                            <div class="confidence-bar">
                                <div class="confidence-fill"
                                    style="width: {{ (prediction.confidence * 100) | round(2) }}%;"></div>
                            </div>
                        </div>
                        {% endfor %}
                        {% endif %}

                        {% if predicted_treatment %}
                        <div class="prediction-card">
                            <h4><i class="fas fa-medkit"></i> Recommended Treatment</h4>
                            <p>{{ predicted_treatment }}</p>
                        </div>
                        {% endif %}

                        {% if prevention_advice %}
                        <div class="prevention-tips">
                            <h4><i class="fas fa-shield-alt"></i> Prevention Tips</h4>
                            <ul>
                                {% for tip in prevention_advice %}
                                <li>{{ tip }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endif %}


                <!-- Statistical widgets -->
                {% if predictions %}
                <div class="stats-container mt-4">
                    <div class="stat-widget">
                        <h3>{{ predictions|length }}</h3>
                        <p>Models Used</p>
                    </div>
                    <div class="stat-widget">
                        <h3>
                            {% set confidences = predictions.values()|map(attribute='confidence')|list %}
                            {{ ((confidences|sum / confidences|length) * 100) | round(2) }}%
                        </h3>
                        <p>Average Confidence</p>
                    </div>
                    <div class="stat-widget">
                        <h3>
                            {% set max_confidence = predictions.values()|map(attribute='confidence')|max %}
                            {{ (max_confidence * 100) | round(2) }}%
                        </h3>
                        <p>Highest Confidence</p>
                    </div>
                </div>

                <!-- Comparison table -->

                <div class="comparison-table mt-4">
                    <h4>Model Comparison</h4>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Model</th>
                                <th>Prediction</th>
                                <th>Confidence</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for model_name, prediction in predictions.items() %}
                            <tr>
                                <td>{{ model_name }}</td>
                                <td>{{ prediction.class }}</td>
                                <td>{{ (prediction.confidence * 100) | round(2) }}%</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>

                <!-- Graph Section -->
                <div class="comparison-table mt-4">
                    <h4>Confidence Score Comparison</h4>
                    <canvas id="confidenceChart"></canvas>
                </div>
                {% endif %}
            </div>

            <!-- Prevention Tab -->
            <div class="tab-pane fade" id="prevention" role="tabpanel" aria-labelledby="prevention-tab">
                <div class="section-container">
                    <h3><i class="fas fa-shield-alt"></i> Disease Prevention Guide</h3>

                    <div class="row mt-4">
                        <div class="col-md-6">
                            <div class="card h-100">
                                <div class="card-header bg-success text-white">
                                    <h5 class="mb-0">General Prevention Practices</h5>
                                </div>
                                <div class="card-body">
                                    <ul>
                                        <li>Use certified disease-free seeds from government-approved sources</li>
                                        <li>Practice crop rotation with pulses or oilseeds</li>
                                        <li>Maintain proper plant spacing (20x15 cm) for air circulation</li>
                                        <li>Ensure balanced fertilization based on soil testing</li>
                                        <li>Practice proper water management - avoid water stagnation</li>
                                        <li>Remove infected plant debris from fields after harvest</li>
                                        <li>Monitor fields regularly for early signs of disease</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card h-100">
                                <div class="card-header bg-success text-white">
                                    <h5 class="mb-0">Seasonal Advice for {{ user_region }}</h5>
                                </div>
                                <div class="card-body">
                                    <h6>Rainy Season (Kharif)</h6>
                                    <ul>
                                        <li>Ensure proper drainage to avoid waterlogging</li>
                                        <li>Apply preventive fungicides like Bavistin before heavy rains</li>
                                        <li>Monitor for fungal diseases which thrive in humidity</li>
                                        <li>Use resistant varieties like Swarna, IR64</li>
                                    </ul>

                                    <h6>Dry Season (Rabi)</h6>
                                    <ul>
                                        <li>Implement proper irrigation practices</li>
                                        <li>Watch for pests that target stressed plants</li>
                                        <li>Use mulch to conserve soil moisture</li>
                                        <li>Apply neem-based pesticides as preventive measure</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4">
                        <h4>Prevention Tips by Disease</h4>
                        <div class="accordion" id="preventionAccordion">
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="headingOne">
                                    <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                        data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                        Bacterial Leaf Blight
                                    </button>
                                </h2>
                                <div id="collapseOne" class="accordion-collapse collapse show"
                                    aria-labelledby="headingOne" data-bs-parent="#preventionAccordion">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>Use resistant varieties like IR20, IR42 when available</li>
                                            <li>Avoid excessive nitrogen fertilization</li>
                                            <li>Practice proper water management to avoid flooding</li>
                                            <li>Remove infected plants and debris</li>
                                            <li>Disinfect tools between uses</li>
                                            <li>Apply copper-based bactericides like Blitox-50 preventively</li>
                                            <li>Spray Streptocycline (500ppm) + Copper oxychloride (0.3%)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="headingTwo">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                        data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                        Brown Spot
                                    </button>
                                </h2>
                                <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo"
                                    data-bs-parent="#preventionAccordion">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>Use certified disease-free seeds</li>
                                            <li>Practice crop rotation with non-rice crops</li>
                                            <li>Ensure balanced nutrition, especially silicon application</li>
                                            <li>Avoid water stress conditions through regular irrigation</li>
                                            <li>Apply appropriate fungicides like Hexaconazole when conditions favor
                                                disease</li>
                                            <li>Remove and destroy infected plant material</li>
                                            <li>Spray Mancozeb (2g/liter) or Carbendazim (1g/liter)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="headingThree">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                        data-bs-target="#collapseThree" aria-expanded="false"
                                        aria-controls="collapseThree">
                                        Leaf Smut
                                    </button>
                                </h2>
                                <div id="collapseThree" class="accordion-collapse collapse"
                                    aria-labelledby="headingThree" data-bs-parent="#preventionAccordion">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>Use resistant varieties if available</li>
                                            <li>Treat seeds with hot water (52-54°C for 10 minutes) or fungicides</li>
                                            <li>Avoid planting in poorly drained soils</li>
                                            <li>Practice crop rotation with non-rice crops for 2 seasons</li>
                                            <li>Apply systemic fungicides like Propiconazole at early growth stages</li>
                                            <li>Remove and destroy severely infected plants</li>
                                            <li>Spray Carbendazim (0.1%) or Tricyclazole (0.1%)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Government Schemes Tab -->
            <div class="tab-pane fade" id="resources" role="tabpanel" aria-labelledby="resources-tab">
                <div class="section-container">
                    <h3><i class="fas fa-hands-helping"></i> Government Schemes for Farmers</h3>

                    <div class="row mt-4">
                        {% for scheme in govt_schemes %}
                        <div class="col-md-6 mb-4">
                            <div class="card scheme-card h-100">
                                <div class="card-header bg-primary text-white">
                                    <h5 class="mb-0">{{ scheme.name }}</h5>
                                </div>
                                <div class="card-body">
                                    <p class="card-text">{{ scheme.description }}</p>
                                    <p><strong>Eligibility:</strong> {{ scheme.eligibility }}</p>
                                    <a href="{{ scheme.link }}" target="_blank" class="btn btn-outline-primary btn-sm">
                                        <i class="fas fa-external-link-alt"></i> Learn More & Apply
                                    </a>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>

                    <div class="mt-4">
                        <h4>Other Farmer Resources</h4>
                        <div class="list-group">
                            <a href="https://farmer.gov.in/" target="_blank"
                                class="list-group-item list-group-item-action">
                                <i class="fas fa-external-link-alt me-2"></i> Farmer Portal of India - Official
                                Government Website
                            </a>
                            <a href="https://www.ikisan.com/" target="_blank"
                                class="list-group-item list-group-item-action">
                                <i class="fas fa-external-link-alt me-2"></i> iKisan - Agricultural Information Portal
                            </a>
                            <a href="https://www.nationalfertilizers.com/index.php" target="_blank"
                                class="list-group-item list-group-item-action">
                                <i class="fas fa-external-link-alt me-2"></i> National Fertilizers Limited
                            </a>
                            <a href="https://www.mandigov.in/" target="_blank"
                                class="list-group-item list-group-item-action">
                                <i class="fas fa-external-link-alt me-2"></i> National Agriculture Market (eNAM)
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Symptoms Tab -->
            <div class="tab-pane fade" id="symptoms" role="tabpanel" aria-labelledby="symptoms-tab">
                <div class="section-container">
                    <h3><i class="fas fa-stethoscope"></i> Symptom Checker</h3>
                    <p>Describe the symptoms you're observing on your rice plants to get potential disease matches.</p>

                    <div class="symptom-checker">
                        <form id="symptomForm">
                            <div class="mb-3">
                                <label for="symptomDescription" class="form-label">Describe the symptoms:</label>
                                <textarea class="form-control" id="symptomDescription" rows="3"
                                    placeholder="e.g., yellow stripes on leaves, black spots, white powdery substance..."></textarea>
                            </div>
                            <button type="button" id="checkSymptoms" class="btn btn-primary">
                                <i class="fas fa-diagnoses"></i> Check Symptoms
                            </button>
                        </form>

                        <div id="symptomResults" class="mt-4" style="display: none;">
                            <h4>Possible Diseases</h4>
                            <div id="diseaseList"></div>
                            <div class="mt-3">
                                <p id="symptomRecommendation"></p>
                            </div>
                        </div>
                    </div>

                    <div class="fertilizer-calculator">
                        <h4><i class="fas fa-calculator"></i> Fertilizer Calculator</h4>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="areaInput" class="form-label">Area (in acres)</label>
                                    <input type="number" class="form-control" id="areaInput" value="1" min="0.1"
                                        step="0.1">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="cropType" class="form-label">Crop Type</label>
                                    <select class="form-select" id="cropType">
                                        <option value="rice">Rice</option>
                                        <option value="wheat">Wheat</option>
                                        <option value="cotton">Cotton</option>
                                        <option value="sugarcane">Sugarcane</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <button type="button" id="calculateFertilizer" class="btn btn-primary">
                            <i class="fas fa-calculator"></i> Calculate Fertilizer Requirements
                        </button>
                        <div id="fertilizerResults" class="mt-3" style="display: none;">
                            <h5>Recommended Fertilizers (per acre)</h5>
                            <div id="fertilizerDetails"></div>
                        </div>
                    </div>

                    <div class="mt-4">
                        <h4>Common Symptoms Reference</h4>
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Symptom</th>
                                        <th>Possible Disease</th>
                                        <th>Recommended Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Yellowish stripes on leaves</td>
                                        <td>Bacterial leaf blight</td>
                                        <td>Spray Copper oxychloride (0.3%)</td>
                                    </tr>
                                    <tr>
                                        <td>Water-soaked lesions</td>
                                        <td>Bacterial leaf blight</td>
                                        <td>Apply Streptocycline (500ppm)</td>
                                    </tr>
                                    <tr>
                                        <td>Small oval brown spots</td>
                                        <td>Brown spot</td>
                                        <td>Spray Mancozeb (2g/liter)</td>
                                    </tr>
                                    <tr>
                                        <td>Dark brown lesions with yellow halos</td>
                                        <td>Brown spot</td>
                                        <td>Apply Carbendazim (1g/liter)</td>
                                    </tr>
                                    <tr>
                                        <td>Black powdery spots</td>
                                        <td>Leaf smut</td>
                                        <td>Spray Propiconazole (0.1%)</td>
                                    </tr>
                                    <tr>
                                        <td>Raised black lesions</td>
                                        <td>Leaf smut</td>
                                        <td>Apply Tricyclazole (0.1%)</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Crop Calendar Tab -->
            <div class="tab-pane fade" id="calendar" role="tabpanel" aria-labelledby="calendar-tab">
                <div class="section-container">
                    <h3><i class="fas fa-calendar-alt"></i> Crop Calendar of INDIA</h3>

                    <div class="row mt-4">
                        {% for state, seasons in crop_calendars.items() %}
                        <div class="col-md-6 mb-4">
                            <div class="card h-100">
                                <div class="card-header bg-info text-white">
                                    <h5 class="mb-0">{{ state }}</h5>
                                </div>
                                <div class="card-body">
                                    {% for season, crops in seasons.items() %}
                                    <h6>{{ season }}</h6>
                                    <ul>
                                        {% for crop in crops %}
                                        <li>{{ crop }}</li>
                                        {% endfor %}
                                    </ul>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>

                    <div class="crop-calendar mt-4">
                        <h4><i class="fas fa-seedling"></i> Rice Growing Seasons in India</h4>
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Kharif Season (June-October)</h5>
                                <ul>
                                    <li>Sowing: June-July</li>
                                    <li>Transplantation: July-August</li>
                                    <li>Harvesting: October-November</li>
                                    <li>Rainfed cultivation</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h5>Rabi Season (November-April)</h5>
                                <ul>
                                    <li>Sowing: November-December</li>
                                    <li>Transplantation: December-January</li>
                                    <li>Harvesting: April-May</li>
                                    <li>Irrigation required</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Expert Help Tab -->
            <div class="tab-pane fade" id="expert" role="tabpanel" aria-labelledby="expert-tab">
                <div class="section-container">
                    <h3><i class="fas fa-user-md"></i> Connect with Agricultural Experts</h3>

                    <div class="row mt-4">
                        <div class="col-md-6">
                            <h4>Local Agricultural Experts in {{ user_region }}</h4>
                            <div id="regionalExperts">
                                {% for expert in local_resources['agricultural_experts'] %}
                                {% if expert.region == user_region or expert.region == 'All India' %}
                                <div class="resource-card">
                                    <h5>{{ expert.name }}</h5>
                                    <p class="mb-1"><strong>Specialization:</strong> {{ expert.specialization }}</p>
                                    <p class="mb-0"><strong>Contact:</strong> {{ expert.contact }}</p>
                                </div>
                                {% endif %}
                                {% endfor %}
                            </div>

                            <h4 class="mt-4">Supply Stores</h4>
                            <div id="regionalStores">
                                {% for store in local_resources['supply_stores'] %}
                                {% if store.region == user_region or store.region == 'All India' %}
                                <div class="resource-card">
                                    <h5>{{ store.name }}</h5>
                                    <p class="mb-1"><strong>Items:</strong> {{ store.items }}</p>
                                    <p class="mb-0"><strong>Location:</strong> {{ store.location }}</p>
                                </div>
                                {% endif %}
                                {% endfor %}
                            </div>
                        </div>

                        <div class="col-md-6">
                            <h4>Extension Services</h4>
                            <div id="regionalServices">
                                {% for service in local_resources['extension_services'] %}
                                {% if service.region == user_region %}
                                <div class="resource-card">
                                    <h5>{{ service.name }}</h5>
                                    <p class="mb-1"><strong>Services:</strong> {{ service.services }}</p>
                                    <p class="mb-0"><strong>Contact:</strong> {{ service.contact }}</p>
                                </div>
                                {% endif %}
                                {% endfor %}
                            </div>

                            <div class="query-form mt-4">
                                <h4>Ask a Question</h4>
                                <form method="POST" action="/submit_query">
                                    <div class="mb-3">
                                        <label for="name" class="form-label">Name</label>
                                        <input type="text" class="form-control" id="name" name="name" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="phone" class="form-label">Phone Number</label>
                                        <input type="tel" class="form-control" id="phone" name="phone" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="location" class="form-label">Location</label>
                                        <input type="text" class="form-control" id="location" name="location" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="query" class="form-label">Your Question</label>
                                        <textarea class="form-control" id="query" name="query" rows="3"
                                            required></textarea>
                                    </div>
                                    <button type="submit" class="btn btn-primary">Submit Question</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>Krishi Raksha - Rice Leaf Disease Prediction System</h5>
                    <p>Using advanced AI models to help Indian farmers identify rice diseases early.</p>

                </div>
                <div class="col-md-6 text-md-end">
                    <p>&copy; 2025 Krishi Raksha - Rice Disease Prediction System</p>
                    <p>Contact: support@krishiraksha.com | Kisan Call Center: 1800-180-1551</p>
                </div>
            </div>
        </div>
    </footer>

    <div class="loading-container" id="loadingIndicator">
        <div class="loading-spinner"></div>
        <p class="text-white mt-3">Processing your image...</p>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Show loading indicator when form is submitted
        document.getElementById('uploadForm').addEventListener('submit', function () {
            document.getElementById('loadingIndicator').style.display = 'flex';

            // Scroll to results after processing (simulate with timeout)
            setTimeout(() => {
                document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
            }, 2000);
        });

        // Auto-hide alerts after 5 seconds
        setTimeout(() => {
            const alerts = document.querySelectorAll('.alert');
            alerts.forEach(alert => {
                alert.style.opacity = '0';
                setTimeout(() => alert.remove(), 300);
            });
        }, 5000);

        // Initialize chart if predictions exist
        {% if predictions %}
        window.addEventListener('load', () => {
            const ctx = document.getElementById('confidenceChart').getContext('2d');
            const confidenceChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [{% for model_name in predictions.keys() %}'{{ model_name }}',{% endfor %}],
            datasets: [{
                label: 'Confidence (%)',
                data: [{% for prediction in predictions.values() %}{{ (prediction.confidence * 100) | round(2) }}, {% endfor %}],
            backgroundColor: ['#4caf50', '#81c784'],
            borderRadius: 8
                    }]
                },
            options: {
            responsive: true,
            plugins: {
                legend: { display: false },
                title: {
                    display: true,
                    text: 'Model Confidence Comparison'
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    max: 100,
                    title: {
                        display: true,
                        text: 'Confidence (%)'
                    }
                },
                x: {
                    title: {
                        display: true,
                        text: 'Models'
                    }
                }
            }
        }
            });
        });
        {% endif %}

        // Symptom checker functionality
        document.getElementById('checkSymptoms').addEventListener('click', function () {
            const symptoms = document.getElementById('symptomDescription').value;
            if (symptoms.trim() === '') {
                alert('Please describe the symptoms you are observing.');
                return;
            }

            // Show loading state
            const checkBtn = document.getElementById('checkSymptoms');
            checkBtn.disabled = true;
            checkBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Analyzing...';

            // Simulate API call (in real application, this would be a fetch to your backend)
            setTimeout(() => {
                // This is a simplified version - in a real app, you'd send this to your backend
                const symptomText = symptoms.toLowerCase();
                const potentialDiseases = [];

                // Check for matches (simplified logic)
                if (symptomText.includes('yellow') || symptomText.includes('stripe') || symptomText.includes('water-soaked')) {
                    potentialDiseases.push('Bacterial leaf blight');
                }
                if (symptomText.includes('brown') || symptomText.includes('spot') || symptomText.includes('lesion')) {
                    potentialDiseases.push('Brown spot');
                }
                if (symptomText.includes('black') || symptomText.includes('powder') || symptomText.includes('smut')) {
                    potentialDiseases.push('Leaf smut');
                }

                // Remove duplicates
                const uniqueDiseases = [...new Set(potentialDiseases)];

                // Display results
                const resultsDiv = document.getElementById('symptomResults');
                const diseaseListDiv = document.getElementById('diseaseList');
                const recommendationDiv = document.getElementById('symptomRecommendation');

                if (uniqueDiseases.length > 0) {
                    diseaseListDiv.innerHTML = '<ul class="list-group">' +
                        uniqueDiseases.map(disease =>
                            `<li class="list-group-item">${disease}</li>`
                        ).join('') +
                        '</ul>';

                    recommendationDiv.textContent = 'Based on your description, these diseases might be affecting your plants. For accurate diagnosis, please upload an image of the affected leaf.';
                } else {
                    diseaseListDiv.innerHTML = '<div class="alert alert-info">No specific diseases identified from your description. Please try to provide more specific symptoms or upload an image for analysis.</div>';
                    recommendationDiv.textContent = '';
                }

                resultsDiv.style.display = 'block';

                // Reset button
                checkBtn.disabled = false;
                checkBtn.innerHTML = '<i class="fas fa-diagnoses"></i> Check Symptoms';
            }, 1500);
        });

        // Fertilizer calculator functionality
        document.getElementById('calculateFertilizer').addEventListener('click', function () {
            const area = parseFloat(document.getElementById('areaInput').value);
            const cropType = document.getElementById('cropType').value;

            if (isNaN(area) || area <= 0) {
                alert('Please enter a valid area value.');
                return;
            }

            // Fertilizer recommendations per acre for different crops
            const fertilizerData = {
                'rice': {
                    'Nitrogen (Urea)': '80-100 kg',
                    'Phosphorus (DAP)': '40-60 kg',
                    'Potassium (MOP)': '40-60 kg',
                    'Zinc Sulphate': '25 kg',
                    'Recommendation': 'Apply 1/3rd nitrogen and full phosphorus & potassium at planting. Rest nitrogen in two splits during tillering and panicle initiation.'
                },
                'wheat': {
                    'Nitrogen (Urea)': '100-120 kg',
                    'Phosphorus (DAP)': '50-60 kg',
                    'Potassium (MOP)': '40-50 kg',
                    'Recommendation': 'Apply 1/3rd nitrogen and full phosphorus & potassium at sowing. Rest nitrogen in two splits during crown root and flowering stages.'
                },
                'cotton': {
                    'Nitrogen (Urea)': '100-120 kg',
                    'Phosphorus (DAP)': '50-60 kg',
                    'Potassium (MOP)': '40-50 kg',
                    'Recommendation': 'Apply 1/3rd nitrogen and full phosphorus & potassium at sowing. Rest nitrogen in two splits during square formation and flowering.'
                },
                'sugarcane': {
                    'Nitrogen (Urea)': '200-250 kg',
                    'Phosphorus (DAP)': '75-100 kg',
                    'Potassium (MOP)': '100-120 kg',
                    'Recommendation': 'Apply fertilizers in three splits - at planting, 60 days after planting, and 120 days after planting.'
                }
            };

            const cropData = fertilizerData[cropType];
            if (!cropData) {
                alert('No fertilizer data available for the selected crop.');
                return;
            }

            const resultsDiv = document.getElementById('fertilizerResults');
            const detailsDiv = document.getElementById('fertilizerDetails');

            let html = '<div class="table-responsive"><table class="table table-bordered"><thead><tr><th>Fertilizer</th><th>Recommended Amount (per acre)</th></tr></thead><tbody>';

            for (const [fertilizer, amount] of Object.entries(cropData)) {
                if (fertilizer !== 'Recommendation') {
                    html += `<tr><td>${fertilizer}</td><td>${amount}</td></tr>`;
                }
            }

            html += '</tbody></table></div>';
            html += `<div class="alert alert-info mt-3"><strong>Application Recommendation:</strong> ${cropData['Recommendation']}</div>`;

            detailsDiv.innerHTML = html;
            resultsDiv.style.display = 'block';
        });

        // Prevention tips buttons
        document.querySelectorAll('.prevention-btn').forEach(button => {
            button.addEventListener('click', function () {
                const disease = this.getAttribute('data-disease');

                // In a real application, this would fetch from the backend
                fetch(`/get_prevention_tips?disease=${encodeURIComponent(disease)}`)
                    .then(response => response.json())
                    .then(data => {
                        alert(`Prevention tips for ${disease}:\n\n- ${data.tips.join('\n- ')}`);
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        // Fallback tips
                        const tips = {
                            'Bacterial leaf blight': [
                                'Use disease-free seeds',
                                'Avoid excessive nitrogen fertilization',
                                'Practice proper water management',
                                'Remove infected plant debris'
                            ],
                            'Brown spot': [
                                'Use resistant varieties',
                                'Maintain proper plant spacing',
                                'Avoid water stress',
                                'Apply balanced fertilization'
                            ],
                            'Leaf smut': [
                                'Use certified disease-free seeds',
                                'Practice crop rotation',
                                'Avoid planting in poorly drained soils',
                                'Apply appropriate fungicides preventively'
                            ]
                        };

                        if (tips[disease]) {
                            alert(`Prevention tips for ${disease}:\n\n- ${tips[disease].join('\n- ')}`);
                        } else {
                            alert('Prevention tips not available for this disease.');
                        }
                    });
            });
        });

        // Update regional resources when region changes
        document.getElementById('regionSelect').addEventListener('change', function () {
            const region = this.value;
            fetch(`/get_region_resources?region=${encodeURIComponent(region)}`)
                .then(response => response.json())
                .then(data => {
                    // Update experts
                    const expertsContainer = document.getElementById('regionalExperts');
                    expertsContainer.innerHTML = '';
                    data.agricultural_experts.forEach(expert => {
                        expertsContainer.innerHTML += `
                            <div class="resource-card">
                                <h5>${expert.name}</h5>
                                <p class="mb-1"><strong>Specialization:</strong> ${expert.specialization}</p>
                                <p class="mb-0"><strong>Contact:</strong> ${expert.contact}</p>
                            </div>
                        `;
                    });

                    // Update stores
                    const storesContainer = document.getElementById('regionalStores');
                    storesContainer.innerHTML = '';
                    data.supply_stores.forEach(store => {
                        storesContainer.innerHTML += `
                            <div class="resource-card">
                                <h5>${store.name}</h5>
                                <p class="mb-1"><strong>Items:</strong> ${store.items}</p>
                                <p class="mb-0"><strong>Location:</strong> ${store.location}</p>
                            </div>
                        `;
                    });

                    // Update services
                    const servicesContainer = document.getElementById('regionalServices');
                    servicesContainer.innerHTML = '';
                    data.extension_services.forEach(service => {
                        servicesContainer.innerHTML += `
                            <div class="resource-card">
                                <h5>${service.name}</h5>
                                <p class="mb-1"><strong>Services:</strong> ${service.services}</p>
                                <p class="mb-0"><strong>Contact:</strong> ${service.contact}</p>
                            </div>
                        `;
                    });
                })
                .catch(error => {
                    console.error('Error fetching regional resources:', error);
                });
        });
    </script>
</body>

</html>